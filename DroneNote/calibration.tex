This section is first describing how the values of the (diagonal) inertia matrix and the four motorresponse reduced parameters can be determined from measurements and will then focus on the procedureintended to provide these measurements.\subsection{Parameters determination}Starting with \eq{torqueEquation}, introducing our new parametrisation from \eq{reducedTauParallel} and\eq{reducedTauPerp} and explicitely introducing the time dependance.\begin{equation}	\v{\tau}(t) = \sum_i{\v{R}_{i,\tau} P_i^2(t)} = I\v{\dot{\omega}}(t) + \v{\omega}(t)\times(I\v{\omega}(t))  \end{equation}Performing two measurements at times $t_1$ and $t_2$ and taking the difference gives\begin{equation}\begin{split}	\sum_i{\v{R}_{i,\tau}(P_i^2(t_1)-P_i^2(t_2))} = I(\v{\dot{\omega}}(t_1)-\v{\dot{\omega}}(t_2))\\	+ (\v{\omega}(t_1)\times(I\v{\omega}(t_1))-\v{\omega}(t_2)\times(I\v{\omega}(t_2)))\end{split}\end{equation}Or the developped form%TODO check the signs\begin{equation}\begin{split}	&\sum_i{(P_i^2(t_1)-P_i^2(t_2))\matrix{R_{i,\tau_x}\\ R_{i,\tau_y}\\ R_{i,\tau_z}}} =	\\&I\matrix{ (\dot{\omega}_x(t_1) - \dot{\omega}_x(t_2)) +	I_1(\omega_y(t_1)\omega_z(t_1) - \omega_y(t_2)\omega_z(t_2))\\	(\dot{\omega}_y(t_1) - \dot{\omega}_y(t_2)) +	I_2(\omega_x(t_1)\omega_z(t_1) - \omega_x(t_2)\omega_z(t_2))\\	(\dot{\omega}_z(t_1) - \dot{\omega}_z(t_2)) +	I_3(\omega_x(t_1)\omega_y(t_1) - \omega_x(t_2)\omega_y(t_2))	}\end{split}\end{equation}This expression is the basis of the calibration and its form suggest two things:\begin{itemize}  \item If the motor powers are not changing between the measurements, the expression becomes independant of the $R_i$  and the $P_i$. This allows the determination of $I_1$, $I_2$ and $I_3$. This operation is basically applying a  rotation to the body and observing how the different axis interacts with each other.  \item If the power of only one motor is varying the contributions of all others are cancelled and the expression  allows to determine the motor response (if the inertia matrix is known).\end{itemize}In the first case the reduced inertia parameters are\begin{align}	I1 = \frac{\dot{\omega}_x(t_2)-\dot{\omega}_x(t_1)}{\omega_y(t_1)\omega_z(t_1)-\omega_y(t_2)\omega_z(t_2)}\\	I2 = \frac{\dot{\omega}_y(t_2)-\dot{\omega}_y(t_1)}{\omega_x(t_1)\omega_z(t_1)-\omega_x(t_2)\omega_z(t_2)}\\	I3 = \frac{\dot{\omega}_z(t_2)-\dot{\omega}_z(t_1)}{\omega_x(t_1)\omega_y(t_1)-\omega_x(t_2)\omega_y(t_2)}\end{align}It gives the relative value of each component en the diagonal elements of the inertia matrix but not the absolute valuewhich is necessary for the appropriate control. However knowing the value of one of the element fixes the value of allthe others. Due to the symetry of the model, the z component is easier to measure than the others and can be fixedexperimentally by the rotation pendulum method\todo{ref}. If $I_{zz}$ is fixed then\begin{align}	I_{xx} = &I_{zz}\frac{1-I_2}{1-I_1I_2}\\	I_{yy} = &I_{zz}\frac{1 - I_2 + I_3 - I_1I_2I_3}{1-I_1I_2}\end{align}In the second case the response parameters of the motor are\begin{align}	R_{i,\tau_x} = I_{xx}\frac{(\dot{\omega}_x(t_1) - \dot{\omega}_x(t_2)) +	I_1(\omega_y(t_1)\omega_z(t_1) - \omega_y(t_2)\omega_z(t_2))}{P_i^2(t_1)-P_i^2(t_2)}\\	R_{i,\tau_y} = I_{yy}\frac{(\dot{\omega}_y(t_1) - \dot{\omega}_y(t_2)) +	I_2(\omega_x(t_1)\omega_z(t_1) - \omega_x(t_2)\omega_z(t_2))}{P_i^2(t_1)-P_i^2(t_2)}\\	R_{i,\tau_z} = I_{zz}\frac{(\dot{\omega}_z(t_1) - \dot{\omega}_z(t_2)) +	I_3(\omega_x(t_1)\omega_y(t_1) - \omega_x(t_2)\omega_y(t_2))}{P_i^2(t_1)-P_i^2(t_2)}\end{align}%TODO reste à faire la détermination de R_TThe procedure to determine the last motor response parameter is similar. Starting from \eq{thrustEquation}, movingit in the body frame, explicitely introcuding the time dependance and isolating $T$.\begin{equation}	\v{T}(t) = m\v{\ddot{x}}'(t) + m\v{g}'(t) - \v{F}_D'(\dot{x})\end{equation}It's important to notice that now even $\v{g}'$ depends on the time as the rotation that transforms the constant $\v{g}$to $\v{g}'$ is time-dependant.The new parametrisation from \eq{reducedThrust} can be introduced and, knowing that only the z component of$\v{T}(t)$ is non zero, considering only this axis.\begin{equation}	\sum_i{R_{i,T}P_i^2(t)} = m\ddot{x}'_z(t) + mg'_z(t) - F_{Dz}'(\dot{x})\end{equation}Again performing two measurements and taking the difference will be helpfull.\begin{equation}\begin{split}	\sum_i{R_{i,T}(P_i^2(t_1)-P_i^2(t_2)} = m((\ddot{x}'_z(t_1)-\ddot{x}'_z(t_2)) + (g'_z(t_1)-g'_z(t_2)))\\	-(F_{Dz}'(\dot{x}_1)-F_{Dz}'(\dot{x}_2))\end{split}\end{equation} Varying the power of a single motor while keeping the others at the same level allows to determine its response factor$R_{i,T}$. The difference compared to the previous case of the torque parameters is the drag force which is dependent onthe velocity and whose value is not known nor measured. The only way to limit its influence on the determination of$R_{i,T}$ is to place the body in a situation where the linear velocity is kept very low on the z axis. In this case, itcan be neglected and the value of the parameter is given by\begin{equation}	R_{i,T} = m\frac{(\ddot{x}'_z(t_1)-\ddot{x}'_z(t_2)) + (g'_z(t_1)-g'_z(t_2))}{P_i^2(t_1)-P_i^2(t_2)}\end{equation}\subsection{Procedure}The procedure is divided into 3 steps that will be individually described later:\begin{enumerate}  \item In order to allow the body to move freely, it cannot touch any obstacle or surface. The first step is to take  off and roughly stabilise the model.  \item Determining several reduced inertia parameters and average them to reduce the impact of disturbances.  \item Determining reduced parameters of each motor in turn\end{enumerate}Between each measurement and step, the model is brought back in the roughly stable position. The execution of thisprocedure also requires the assumptions that the model is well balanced, roughly symetrical by rotation of$\frac{\pi}{2}$ radians around the z axis and that all the motors have a similar response to the input signal. Thecalibration procedure will correct for deviations from these hypotheses.As nothing is supposed known about the model, the first step is executed carrefully by applying to all motors the samepower $P_1=P_2=P_3=P_4$, starting with 0 and sequentially increasing it until the vertical linear acceleration startsincreasing. The power is then kept at the same level while doubly integrating the acceleration to approximate thevertical displacement. When a height of $~50$cm is reached, the motor powers are reduced to the power $P_{i,S}$ forwhich the vertical acceleration vanishes. The model is know supposed to have reached a roughly steady state at $~50$cmfrom the ground.For the determination of the reduced inertia parameters, the power on one of the motors is slightly increased by anamount $\Delta P_i$ and kept at the same level for for a short duration $\Delta t$ to leave the steady flight. A loop ofmeasurement is started:\begin{enumerate}  \item The power of the motor is set to $P_{i,S}+(-1)^j\Delta P_i$ and after a time $\Delta t$, the measurement is  done. $j$ is the index of the loop, starting with 0.  \item After a delay $\Delta t$, a second measurement is done.\end{enumerate} The body is put back in its original steady flight state by setting the motor power to $P_{i,S}-\Delta P$ for a period$\Delta t$. The period $\Delta t$ is used to reduce the dependance on ramp up/down time ar any delay in the motor response time.A similar sequence is applied to each motor in turn for the determination of their parameters.\begin{enumerate}  \item A power $P_{i,S}+\Delta P$ is applied to the tested motor for a period $\Delta t$ to leave the steady flight  state before performing the first measurement.  \item A power $P_{i,S}+2\Delta P$ is applied for a period $\Delta t$ and the second measurement is performed.  \item The quadricopter is brought back in position for the next motor by applying a power $P_{i,S}-2\Delta P$ during  $\Delta t$ followed by $P_{i,S}-\Delta P$ during $\Delta t$.\end{enumerate}  